(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-754978bf"],{"1ef1":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"300px"},attrs:{placeholder:"请输入姓名或工号搜索",clearable:""},on:{clear:e.clearSearch},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilter(t)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),e._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v("搜索")]),e._v(" "),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.handleCreate}},[e._v("添加")]),e._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-download"},on:{click:e.handleDownload}},[e._v("导出")])],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e._f("pagination")(e.teacher_list,e.currentPage,e.pagesize),border:"",fit:"","highlight-current-row":"",stripe:""}},[a("el-table-column",{attrs:{label:"序号",prop:"id",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){t.row;var n=t.$index;return[a("span",[e._v(e._s(n+1))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"姓名","min-width":"250px",width:"400px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.user_name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"工号",width:"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.teacher_info.teacher_id))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"负责学院","min-width":"250px",width:"400px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.teacher_info.management_faculty))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row,i=t.$index;return[a("el-button",{attrs:{type:"primary",icon:"el-icon-setting",size:"mini"},on:{click:function(t){return e.handleUpdate(n)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini",icon:"el-icon-delete"},on:{click:function(t){return e.handleDelete(n,i)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("div",{staticClass:"pagination",staticStyle:{margin:"10px 10px 10px 0",float:"right"}},[a("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[5,10,20],"page-size":e.pagesize,total:e.total,layout:"prev, pager, next, sizes, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"dataForm",staticStyle:{width:"450px","margin-left":"20px"},attrs:{model:e.temp,"label-position":"right","label-width":"100px"}},[a("el-form-item",{attrs:{label:"姓名",prop:"name"}},[a("el-input",{model:{value:e.temp.user_name,callback:function(t){e.$set(e.temp,"user_name",t)},expression:"temp.user_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"工号",prop:"number"}},[a("el-input",{model:{value:e.temp.teacher_info.teacher_id,callback:function(t){e.$set(e.temp.teacher_info,"teacher_id",t)},expression:"temp.teacher_info.teacher_id"}})],1),e._v(" "),a("el-form-item",{attrs:{"label-width":"100px",label:"负责学院",prop:"management_faculty"}},[a("el-input",{model:{value:e.temp.teacher_info.management_faculty,callback:function(t){e.$set(e.temp.teacher_info,"management_faculty",t)},expression:"temp.teacher_info.management_faculty"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"权限",prop:"permission"}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"350px"},attrs:{placeholder:"权限"},model:{value:e.temp.user_role,callback:function(t){e.$set(e.temp,"user_role",t)},expression:"temp.user_role"}},e._l(e.calendarTypeOptions,(function(e){return a("el-option",{key:e.key,attrs:{label:e.display_name,value:e.key}})})),1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){"create"===e.dialogStatus?e.createData():e.updateData()}}},[e._v("提交")])],1)],1)],1)},i=[],r=a("db72"),l=a("2f62"),s=a("bc3a"),c=a.n(s),o=[{key:"teacher",display_name:"老师"},{key:"0",display_name:"无权限"}],u={name:"ComplexTable",data:function(){return{keyword:"",currentPage:1,pagesize:10,total:0,id:"",teacher_list:[],copy_teacher_list:[],calendarTypeOptions:o,temp:{user_name:"",teacher_info:"",user_role:""},dialogFormVisible:!1,dialogStatus:"",textMap:{update:"编辑",create:"添加"}}},computed:Object(r["a"])({},Object(l["b"])(["name"])),mounted:function(){this.getList()},methods:{getList:function(){var e=this;c.a.get("http://123.56.88.197:8081/teacher/get_teacher").then((function(t){200===t.data.code?(e.teacher_list=t.data.data,e.total=e.teacher_list.length,e.copy_teacher_list=JSON.parse(JSON.stringify(e.teacher_list))):e.$message({type:"error",message:"获取老师数据错误"})})).catch((function(e){}))},handleCreate:function(){var e=this;this.resetTemp(),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick((function(){e.$refs["dataForm"].clearValidate()}))},createData:function(){var e=this;this.$refs["dataForm"].validate((function(t){t&&c.a.post("http://123.56.88.197:8081/teacher/add_teacher",{teacher_name:e.temp.user_name,teacher_id:e.temp.teacher_info.teacher_id,management_faculty:e.temp.teacher_info.management_faculty,teacher_permission:e.temp.user_role}).then((function(t){200===t.data.code&&(e.dialogFormVisible=!1,e.$message({type:"success",message:"添加老师信息成功"}),e.getList())})).catch((function(e){}))}))},handleUpdate:function(e){var t=this;this.temp=Object.assign({},e),this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick((function(){t.$refs["dataForm"].clearValidate()}))},updateData:function(){var e=this;this.$refs["dataForm"].validate((function(t){t&&c.a.get("http://123.56.88.197:8081/teacher/update_teacher?user_name="+e.temp.user_name+"&management_faculty="+e.temp.teacher_info.management_faculty+"&user_role="+e.temp.user_role).then((function(t){200===t.data.code?(e.dialogFormVisible=!1,e.$message({type:"success",message:"修改老师信息成功"}),e.getList()):e.$message({type:"success",message:"修改老师信息失败"})})).catch((function(e){}))}))},handleDelete:function(e,t){var a=this;c.a.get("http://123.56.88.197:8081/teacher/del_teacher?user_name="+e.user_name).then((function(e){200===e.data.code?(a.teacher_list.splice(t,1),a.$message({type:"success",message:"删除老师信息成功"})):a.$message({type:"error",message:"删除老师信息失败"})})).catch((function(e){}))},handleDownload:function(){for(var e=["姓名","工号","负责学院"],t=this.teacher_list,a="",n=0;n<e.length;n++)a+=e[n]+",";a+="\n";for(var i=0;i<t.length;i++)a+=t[i].user_name+","+t[i].teacher_info.teacher_id+","+t[i].teacher_info.management_faculty+"\n";var r="data:text/csv;charset=utf-8,\ufeff"+encodeURIComponent(a),l=document.createElement("a");l.href=r,l.download="分管老师列表.xlsx",document.body.appendChild(l),l.click(),document.body.removeChild(l)},handleSizeChange:function(e){this.pagesize=e},handleCurrentChange:function(e){this.currentPage=e},handleFilter:function(){var e=this;this.keyword?(this.teacher_list=this.copy_teacher_list.filter((function(t){return JSON.stringify(t.teacher_info.teacher_id).indexOf(e.keyword)>-1||JSON.stringify(t.user_name).indexOf(e.keyword)>-1})),this.total=this.teacher_list.length,this.currentPage=1):(this.teacher_list=this.copy_teacher_list,this.total=this.teacher_list.length)},clearSearch:function(){this.handleFilter()},resetTemp:function(){this.temp={teacher_name:"",teacher_id:"",teacher_info:{}}}},filters:{pagination:function(e,t,a){var n=(t-1)*a,i=n+a>=e.length?e.slice(n,e.length):e.slice(n,n+a);return i}}},d=u,h=(a("a3bd"),a("2877")),p=Object(h["a"])(d,n,i,!1,null,null,null);t["default"]=p.exports},"8c3e":function(e,t,a){},a3bd:function(e,t,a){"use strict";var n=a("8c3e"),i=a.n(n);i.a}}]);